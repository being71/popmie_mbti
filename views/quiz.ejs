<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Kuis MBTI Pop Mie üçú</title>
    <link rel="stylesheet" href="/css/style.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css"
    />
  </head>
  <body class="body-bg">
    <div class="body-overlay">
      <div class="container text-center">
        <h1 class="mb-4 logo-heading">
          <img src="/images/popmie.png" alt="Popmie Logo" class="logo-img" />
          Kuis MBTI Pop Mie
        </h1>

        <div id="quiz-box" class="card p-3 shadow container-card">
          <!-- Progress Bar di atas pertanyaan -->
          <div class="progress" style="height: 12px">
            <div class="progress-bar" id="progress-bar" style="width: 0%"></div>
          </div>
          <!-- Pertanyaan -->
          <h2 id="question-text" class="question-text"></h2>
          <!-- Tombol jawaban -->
          <div class="answer-buttons">
            <button class="btn btn-primary btn-lg w-100" id="btnA"></button>
            <button
              class="btn btn-outline-primary btn-lg w-100"
              id="btnB"
            ></button>
          </div>
        </div>
      </div>
    </div>

    <form id="result-form" method="POST" action="/result" style="display: none">
      <input type="hidden" name="answers" id="answers-input" />
    </form>

    <script>
      const questions = <%- JSON.stringify(questions) %>;
      let currentIndex = 0;
      let answers = [];

      const questionText = document.getElementById("question-text");
      const btnA = document.getElementById("btnA");
      const btnB = document.getElementById("btnB");
      const progressBar = document.getElementById("progress-bar");

      function loadQuestion() {
      const q = questions[currentIndex];
      questionText.textContent = q.question; // \n akan diterjemahkan menjadi line break
      btnA.textContent = q.options[0].text;
      btnB.textContent = q.options[1].text;
      progressBar.style.width = `${(currentIndex / questions.length) * 100}%`;
      }


      function selectAnswer(value) {
        answers.push(value);
        currentIndex++;
        if (currentIndex < questions.length) {
          loadQuestion();
        } else {
          document.getElementById("answers-input").value = answers.join(",");
          document.getElementById("result-form").submit();
        }
      }

      btnA.addEventListener("click", () => selectAnswer(questions[currentIndex].options[0].value));
      btnB.addEventListener("click", () => selectAnswer(questions[currentIndex].options[1].value));

      loadQuestion();
    </script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
  </body>
</html>
